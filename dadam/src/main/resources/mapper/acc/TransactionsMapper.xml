<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.dadam.acc.credit.mapper.TransactionsMapper">
	<!-- 목업용, 실제 쿼리 없음 -->
	<select id="selectAll" resultType="TransactionsVO">
		SELECT * , v.acct_no
		FROM transaction t
		JOIN vender v ON t.acct_no = v.acct_no
		WHERE com_id = #{comId}
	</select>


	<insert id="insert" parameterType="TransactionsVO">
		<selectKey keyProperty="txnHistCode" resultType="string"
			order="BEFORE">
			SELECT 'txh-' || LPAD(NVL(MAX(TO_NUMBER(SUBSTR(txn_hist_code, 5))), 0) + 1, 3, '0') AS txn_code
			FROM transaction
		</selectKey>
		INSERT INTO transaction (
		txn_hist_code
		, txn_date
		, txn_type
		, txn_name
		, txn_memo
		, price
		, balance
		, bank
		, acct_no
		, com_id
		) VALUES (
		#{txnHistCode}
		, SYSDATE
		, #{txnType}
		, #{txnName}
		, #{txnMemo}
		, #{price}
		, #{balance}
		, #{bank}
		, #{acctNo}
		, #{comId}
		)
	</insert>




</mapper> 